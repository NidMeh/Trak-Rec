<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trak Recovery</title>
<style>
  body {
    font-family: 'Inter', sans-serif;
    background-color: #0d0d0d;
    color: #f5f5f5;
    margin: 0;
    padding: 0;
    text-align: center;
  }
  header {
    padding: 20px;
    font-size: 1.5em;
    font-weight: bold;
    background-color: #111;
    border-bottom: 1px solid #222;
  }
  .stat {
    margin: 15px 0;
    font-size: 1.2em;
  }
  button {
    padding: 12px 18px;
    margin: 8px;
    background-color: #1f1f1f;
    border: none;
    color: white;
    font-size: 1em;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s;
  }
  button:hover {
    background-color: #333;
  }
  .xp-bar {
    width: 80%;
    background-color: #222;
    border-radius: 10px;
    margin: 10px auto;
    height: 20px;
    overflow: hidden;
  }
  .xp-fill {
    height: 100%;
    background-color: #4cafef;
    width: 0%;
    transition: width 0.4s;
  }
  textarea {
    width: 80%;
    padding: 8px;
    margin: 10px 0;
    background: #111;
    border: 1px solid #333;
    color: white;
    border-radius: 5px;
  }
</style>
</head>
<body>

<header>Trak Recovery</header>

<div class="stat">Current Streak: <span id="streak">0</span> days</div>
<div class="stat">Highest Streak: <span id="highStreak">0</span> days</div>
<div class="stat">XP: <span id="xp">0</span> / <span id="xpGoal">100</span></div>

<div class="xp-bar">
  <div class="xp-fill" id="xpFill"></div>
</div>

<div>
  <button onclick="addDay()">Add Day</button>
  <button onclick="resetStreak()">Log Relapse</button>
</div>

<hr style="margin: 20px 0; border: 0; border-top: 1px solid #333;">

<h3>Journal</h3>
<textarea id="journalInput" placeholder="How was your day?"></textarea>
<br>
<button onclick="saveJournal()">Save Journal</button>

<hr style="margin: 20px 0; border: 0; border-top: 1px solid #333;">

<h3>Urge Timer</h3>
<div class="stat">Urge Duration: <span id="urgeTime">0</span> seconds</div>
<button onclick="startUrge()">Start</button>
<button onclick="stopUrge()">Stop</button>

<script>
  let streak = parseInt(localStorage.getItem('streak')) || 0;
  let highStreak = parseInt(localStorage.getItem('highStreak')) || 0;
  let xp = parseInt(localStorage.getItem('xp')) || 0;
  let xpGoal = 100;
  let urgeStartTime = null;

  document.getElementById('streak').textContent = streak;
  document.getElementById('highStreak').textContent = highStreak;
  document.getElementById('xp').textContent = xp;
  document.getElementById('xpGoal').textContent = xpGoal;
  updateXPBar();

  function addDay() {
    streak++;
    xp += 10;
    if (xp >= xpGoal) {
      xp -= xpGoal;
      xpGoal += 50;
      alert("ðŸŽ‰ Level Up!");
    }
    if (streak > highStreak) {
      highStreak = streak;
    }
    saveStats();
  }

  function resetStreak() {
    streak = 0;
    saveStats();
  }

  function saveStats() {
    localStorage.setItem('streak', streak);
    localStorage.setItem('highStreak', highStreak);
    localStorage.setItem('xp', xp);
    document.getElementById('streak').textContent = streak;
    document.getElementById('highStreak').textContent = highStreak;
    document.getElementById('xp').textContent = xp;
    updateXPBar();
  }

  function updateXPBar() {
    document.getElementById('xpFill').style.width = (xp / xpGoal) * 100 + '%';
    document.getElementById('xpGoal').textContent = xpGoal;
  }

  function saveJournal() {
    let text = document.getElementById('journalInput').value;
    let date = new Date().toLocaleDateString();
    localStorage.setItem('journal-' + date, text);
    alert("Journal saved for " + date);
  }

  function startUrge() {
    urgeStartTime = Date.now();
  }

  function stopUrge() {
    if (urgeStartTime) {
      let duration = Math.floor((Date.now() - urgeStartTime) / 1000);
      document.getElementById('urgeTime').textContent = duration;
      alert("Urge lasted " + duration + " seconds. You survived it!");
      urgeStartTime = null;
    }
  }
</script>

</body>
</html>
